<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø£Ø¨Ù‚Ø±Ø§Ø· Ù„Ù„ØªØ¯Ø±ÙŠØ¨</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <!-- CSS Styles -->
    <style>
        .brand-green { color: #0f5132; }
        .brand-green-bg { background-color: #198754; }
        .brand-green-bg:hover { background-color: #157347; }
        .hta-logo { max-height: 80px; }
        .registration-fields { display: none; }
        .payment-card { transition: transform 0.2s; }
        .payment-card:hover { transform: translateY(-5px); }
        form ol {
            padding-right: 1.2rem;
            padding-left: 0;
        }
        .instructor-name, .cpd-points-display {
            font-size: 0.9em;
            color: #6c757d;
            display: block;
            margin-top: 2px;
        }
        .custom-country-code-dropdown {
            flex: 0 0 auto;
            width: 180px;
            position: relative;
        }
        .custom-country-code-dropdown .form-control {
            padding-right: 2.5rem;
            padding-left: 0.75rem;
        }
        .custom-country-code-dropdown::after {
            content: '\f078';
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            position: absolute;
            right: 1rem;
            left: auto;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: #6c757d;
        }
        .country-list {
            position: absolute;
            top: 100%;
            right: 0;
            left: 0;
            border: 1px solid #ced4da;
            border-top: none;
            background-color: white;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            list-style-type: none;
            padding: 0;
            margin: 0;
            border-radius: 0 0 0.375rem 0.375rem;
            text-align: right;
        }
        .country-list li {
            padding: 0.6rem 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .country-list li:hover, .country-list li[aria-selected="true"] {
            background-color: #f8f9fa;
        }
        .country-list li.selected {
            background-color: #e9ecef;
            font-weight: bold;
        }
        #phone-number {
             direction: ltr;
             text-align: left;
             flex: 1 1 auto;
             width: 1%;
             min-width: 200px;
        }
        #country-code-search {
            width: 100%;
        }
        .input-group {
            direction: ltr;
        }
        /* Custom Navbar Style */
        .navbar-custom-bg {
            background: linear-gradient(to left, #7c2bc9, #6a0dad);
        }
        .navbar-custom-bg .navbar-nav .nav-link {
            color: #f8f9fa;
            font-weight: 500;
        }
        .navbar-custom-bg .navbar-nav .nav-link:hover {
            color: #ffffff;
        }
        .brand-name-en {
            margin-right: 0.5rem;
        }

        /* === ØªØ­Ø³ÙŠÙ†Ø§Øª ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ù†ÙˆØ§Ù† === */
        .page-title-wrapper {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            padding-bottom: 1rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.8s ease-out 0.3s forwards;
        }

        .page-title-wrapper::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, #6a0dad, #198754);
            border-radius: 2px;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            line-height: 1.3;
            color: #212529;
        }

        .page-subtitle {
            font-size: 1.3rem;
            color: #6a0dad;
            margin-bottom: 0;
            font-weight: 500;
        }
        /* === Ù†Ù‡Ø§ÙŠØ© ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… === */

    </style>
</head>
<body>

    <!-- Ù†ÙˆØ§ÙØ° Ù…Ù†Ø¨Ø«Ù‚Ø© Ù…Ø®ØµØµØ© Ù„Ù„Ø£Ø®Ø·Ø§Ø± ÙˆØ§Ù„Ù†Ø¬Ø§Ø­ -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="errorModalLabel"><i class="fas fa-exclamation-triangle me-2"></i>Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="errorMessage"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="successModalLabel"><i class="fas fa-check-circle me-2"></i>ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="successMessage"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal">Ù…ØªØ§Ø¨Ø¹Ø©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- HTML Body Content -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom-bg">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <span class="brand-name-ar">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø£Ø¨Ù‚Ø±Ø§Ø· Ù„Ù„ØªØ¯Ø±ÙŠØ¨</span>
                <span class="brand-name-hta d-inline-block d-lg-none"> | HTA</span>
                <span class="brand-name-en d-none d-lg-inline-block">| Hippocrates Training Academy</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section id="registration-section" class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10">
                <div class="card shadow-lg">
                    <div class="card-body p-4 p-md-5">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <div>
                                <div class="page-title-wrapper">
                                    <h1 class="page-title">
                                        <span style="color: black;">Ù…Ù†ØµØ©</span> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©
                                    </h1>
                                    <p class="page-subtitle">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø£Ø¨Ù‚Ø±Ø§Ø· Ù„Ù„ØªØ¯Ø±ÙŠØ¨</p>
                                </div>
                                <p class="text-muted" id="course-details-display"></p>
                            </div>
                            <img src="hta-logo.png" alt="Ø´Ø¹Ø§Ø± Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø£Ø¨Ù‚Ø±Ø§Ø·" class="hta-logo" loading="lazy">
                        </div>

                        <div class="mb-4">
                            <label for="course-selector" class="form-label h5">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø§Ù„ØªÙŠ ØªØ±ØºØ¨ Ø¨Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù‡Ø§</label>
                            <select class="form-select form-select-lg" id="course-selector" required onchange="onCourseSelect()" disabled>
                                <option value="" disabled selected>... Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© <i class="fas fa-spinner fa-spin"></i></option>
                            </select>
                        </div>

                        <div id="registration-fields" class="registration-fields">
                            <div class="alert alert-info" role="alert">
                                <i class="fas fa-info-circle"></i> <strong>Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø©:</strong> Ø¨Ø¹Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ØŒ Ø³ØªØ¸Ù‡Ø± Ù„Ùƒ <strong>Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</strong> ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„.
                            </div>

                            <form id="registrationForm" class="g-3" role="form" novalidate>
                                <input type="hidden" id="course-id-input" name="Course ID">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="fullNameAr" class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ (Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)</label>
                                        <input type="text" class="form-control" id="fullNameAr" name="Full Name (Arabic)" required aria-describedby="nameAr-help">
                                        <div id="nameAr-help" class="form-text">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø­Ø±Ù Ø¹Ø±Ø¨ÙŠØ© ÙÙ‚Ø·.</div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="fullNameEn" class="form-label">Full Name (English)</label>
                                        <input type="text" class="form-control" id="fullNameEn" name="Full Name (English)" required aria-describedby="nameEn-help">
                                        <div id="nameEn-help" class="form-text">ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø­Ø±Ù Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·.</div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="email" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                                        <input type="email" class="form-control" id="email" name="Email" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="phone-number" class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (ÙˆØ§ØªØ³Ø§Ø¨)</label>
                                        <div class="input-group">
                                             <input type="tel" class="form-control" id="phone-number" name="Phone Number" placeholder="Ù…Ø«Ø§Ù„: 79xxxxxxx" required aria-label="Phone number" aria-describedby="phone-help">
                                            <div class="custom-country-code-dropdown">
                                                <input type="text" class="form-control" id="country-code-search" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆÙ„Ø© Ù„Ù„Ø¨Ø­Ø«" autocomplete="off" role="combobox" aria-haspopup="listbox" aria-expanded="false" aria-owns="country-list">
                                                <input type="hidden" id="country-code-value" name="CountryCode" value="+962">
                                                <ul class="country-list" id="country-list" style="display: none;" role="listbox"></ul>
                                            </div>
                                        </div>
                                        <div id="phone-help" class="form-text text-muted">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø¨Ø¯ÙˆÙ† Ø§Ù„ØµÙØ± ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ù…Ø«Ø§Ù„: 79xxxxxxx). ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¯ÙˆÙ„Ø© Ø¨ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ù…Ø¬Ø§ÙˆØ±.</div>
                                    </div>
                                </div>
                                 <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="nationality" class="form-label">Ø§Ù„Ø¬Ù†Ø³ÙŠØ©</label>
                                        <select class="form-select" id="nationality" name="Nationality" required onchange="toggleOtherNationality(this.value)">
                                            <option value="" disabled selected>Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØªÙƒ</option>
                                            <option value="Ø§Ù„Ø£Ø±Ø¯Ù†">Ø§Ù„Ø£Ø±Ø¯Ù†</option>
                                            <option value="Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
                                            <option value="Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†">Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
                                            <option value="ØªÙˆÙ†Ø³">ØªÙˆÙ†Ø³</option>
                                            <option value="Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±">Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
                                            <option value="Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±">Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±</option>
                                            <option value="Ø¬ÙŠØ¨ÙˆØªÙŠ">Ø¬ÙŠØ¨ÙˆØªÙŠ</option>
                                            <option value="Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
                                            <option value="Ø§Ù„Ø³ÙˆØ¯Ø§Ù†">Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</option>
                                            <option value="Ø³ÙˆØ±ÙŠØ§">Ø³ÙˆØ±ÙŠØ§</option>
                                            <option value="Ø§Ù„ØµÙˆÙ…Ø§Ù„">Ø§Ù„ØµÙˆÙ…Ø§Ù„</option>
                                            <option value="Ø§Ù„Ø¹Ø±Ø§Ù‚">Ø§Ù„Ø¹Ø±Ø§Ù‚</option>
                                            <option value="Ø¹ÙÙ…Ø§Ù†">Ø¹ÙÙ…Ø§Ù†</option>
                                            <option value="ÙÙ„Ø³Ø·ÙŠÙ†">ÙÙ„Ø³Ø·ÙŠÙ†</option>
                                            <option value="Ù‚Ø·Ø±">Ù‚Ø·Ø±</option>
                                            <option value="Ø§Ù„ÙƒÙˆÙŠØª">Ø§Ù„ÙƒÙˆÙŠØª</option>
                                            <option value="Ù„Ø¨Ù†Ø§Ù†">Ù„Ø¨Ù†Ø§Ù†</option>
                                            <option value="Ù„ÙŠØ¨ÙŠØ§">Ù„ÙŠØ¨ÙŠØ§</option>
                                            <option value="Ù…ØµØ±">Ù…ØµØ±</option>
                                            <option value="Ø§Ù„Ù…ØºØ±Ø¨">Ø§Ù„Ù…ØºØ±Ø¨</option>
                                            <option value="Ø§Ù„ÙŠÙ…Ù†">Ø§Ù„ÙŠÙ…Ù†</option>
                                            <option value="Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§">Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§</option>
                                            <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                        </select>
                                        <div id="other-nationality-field" class="mt-2" style="display:none;">
                                            <input type="text" class="form-control" name="Other Nationality" placeholder="ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø¨Ù„Ø¯Ùƒ">
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="degree" class="form-label">Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</label>
                                        <select class="form-select" id="degree" name="Academic Degree">
                                            <option>Ø¹Ù„Ù‰ Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³Ø© / Student</option>
                                            <option>Ø¨ÙƒØ§Ù„ÙˆØ±ÙŠÙˆØ³ / Bachelor</option>
                                            <option>Ù…Ø§Ø¬Ø³ØªÙŠØ± / Master</option>
                                            <option>Ø¯ÙƒØªÙˆØ±Ø§Ù‡ / PhD</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="cpd" class="form-label">Ù‡Ù„ ØªØ±ØºØ¨ Ø¨Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ù…Ù‡Ù†ÙŠ Ø§Ù„Ù…Ø³ØªÙ…Ø± (CPD)ØŸ</label>
                                    <select class="form-select" id="cpd" name="CPD Request" onchange="toggleCPDFields(this.value)">
                                        <option value="Ù„Ø§">Ù„Ø§</option>
                                        <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option>
                                    </select>
                                </div>

                                <div id="cpd-fields" style="display:none;">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="nationalId" class="form-label">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ</label>
                                            <input type="text" class="form-control" id="nationalId" name="National ID">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="licenseNo" class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù…Ø²Ø§ÙˆÙ„Ø© (ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø©)</label>
                                            <input type="text" class="form-control" id="licenseNo" name="License Number">
                                        </div>
                                    </div>
                                    <p class="text-success small">âœ… Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© <span id="cpd-fee-display">5</span> Ø¯Ù†Ø§Ù†ÙŠØ± Ø¥Ù„Ù‰ Ø±Ø³ÙˆÙ… Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ù…Ù‚Ø§Ø¨Ù„ Ø´Ù‡Ø§Ø¯Ø© CPD.</p>
                                </div>

                                <div class="alert alert-secondary" role="alert">
                                    ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: <strong id="total-fee">...</strong>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">Ø§Ù„ØªØ¹Ù‡Ø¯ ÙˆØ§Ù„Ø¥Ù‚Ø±Ø§Ø±:</label>
                                    <div class="border p-3" style="max-height: 200px; overflow-y: auto; background-color: #f8f9fa; font-size: 0.9rem;">
                                        <p>Ø£ØªØ¹Ù‡Ø¯ Ø£Ù†Ø§ØŒ Ù…Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØŒ Ø¨Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨Ø¥Ø¯Ø®Ø§Ù„Ù‡Ø§ ØµØ­ÙŠØ­Ø© ÙˆØ¯Ù‚ÙŠÙ‚Ø©.</p>
                                        <p>ÙƒÙ…Ø§ Ø£Ù‚Ø±Ù‘ Ø¨Ø£Ù†Ù†ÙŠ Ø¹Ù„Ù‰ Ø¯Ø±Ø§ÙŠØ© ØªØ§Ù…Ø© Ø¨Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø§Ù„ØªÙŠ Ø£Ø³Ø¬Ù„ ÙÙŠÙ‡Ø§ØŒ ÙˆÙ…Ø§ Ù‚Ø¯ ØªØªØ¶Ù…Ù†Ù‡ - Ø¥Ù† ÙˆÙØ¬Ø¯ - Ù…Ù† ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¹Ù…Ù„ÙŠØ© Ø£Ùˆ ØªØ¯Ø§Ø®Ù„Ø§Øª Ø¶Ù…Ù† Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø§Ù„ØªÙŠ Ù‚Ø¯ ØªØ´Ù…Ù„Ù†ÙŠ Ø£Ùˆ Ø§Ù„Ø²Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†.</p>
                                        <p>ÙˆØ£ØªØ¹Ù‡Ø¯ Ø¨Ù…Ø§ ÙŠÙ„ÙŠ:</p>
                                        <ol>
                                            <li>Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø®ØµÙˆØµÙŠØ© Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© ÙˆØ§Ø­ØªØ±Ø§Ù… Ø®ØµÙˆØµÙŠØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ† ÙˆØ§Ù„Ø²Ù…Ù„Ø§Ø¡.</li>
                                            <li>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø­Ø¶ÙˆØ± ÙƒØ§Ù…Ù„ Ù…Ø¯Ø© Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© ÙˆÙÙ‚ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ù…Ø¹Ù„Ù†.</li>
                                            <li>Ø£ØªÙÙ‡Ù… ÙˆØ£Ù‚Ø±Ù‘ Ø¨Ø£Ù† Ø¹Ø¯Ù… Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ø£ÙŠ Ù…Ù† Ø£ÙŠØ§Ù… Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ù‚Ø¯ ÙŠØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ø¹Ø¯Ù… Ø§Ø³ØªØ­Ù‚Ø§Ù‚ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (ÙÙŠ Ø­Ø§Ù„ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø© Ù„ØªÙ„Ùƒ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©).</li>
                                            <li>Ø£Ù‚Ø±Ù‘ Ø¨Ø£Ù†Ù†ÙŠ Ø§Ø·Ù„Ø¹Øª Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„ØªØºÙŠÙŠØ± Ù„Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø§Ù„ØµØ§Ø¯Ø±Ø© Ø¹Ù† Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø£Ø¨Ù‚Ø±Ø§Ø· Ù„Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ§Ù„ÙŠØŒ ÙˆØ£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø¨Ù†ÙˆØ¯Ù‡Ø§ ÙˆØ´Ø±ÙˆØ·Ù‡Ø§ Ø¯ÙˆÙ† ØªØ­ÙØ¸:
                                                <br>
                                                <a href="https://drive.google.com/open?id=1O5Q2ryIn4Eh5nsQf2Ycn7SytKWDKL0ql&usp=drive_fs" class="brand-green" target="_blank">ğŸ”— Ø³ÙŠØ§Ø³Ø© Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„ØªØºÙŠÙŠØ± Ù„Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©</a>
                                            </li>
                                            <li>Ø£ØªÙÙ‡Ù… Ø£Ù† Ø¨Ø¹Ø¶ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ù‚Ø¯ Ù„Ø§ ØªØªØ¶Ù…Ù† Ø´Ù‡Ø§Ø¯Ø© Ù…Ø´Ø§Ø±ÙƒØ© Ø£Ùˆ ØªØ¯Ø±ÙŠØ¨Ù‹Ø§ Ø¹Ù…Ù„ÙŠÙ‹Ø§ØŒ ÙˆØ°Ù„Ùƒ Ø¨Ø­Ø³Ø¨ Ø·Ø¨ÙŠØ¹Ø© ÙƒÙ„ ÙØ¹Ø§Ù„ÙŠØ©.</li>
                                        </ol>
                                        <p><strong>ÙˆØ¨Ø°Ù„Ùƒ Ø£ØªØ­Ù…Ù„ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø¹Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù…Ø§ ÙˆØ±Ø¯ Ø£Ø¹Ù„Ø§Ù‡.</strong></p>
                                    </div>
                                </div>

                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="terms" required>
                                    <label class="form-check-label" for="terms">
                                        Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù‡Ø¯ ÙˆØ§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø£Ø¹Ù„Ø§Ù‡ ÙˆØ£Ø¹Ù„Ù… Ø£Ù† Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù„Ù† ÙŠÙƒØªÙ…Ù„ Ø¥Ù„Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹.
                                    </label>
                                </div>

                                <button type="submit" class="btn brand-green-bg text-white btn-lg w-100">
                                    Ø£Ø±Ø³Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙŠ ÙˆØ§Ø¹Ø±Ø¶ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="payment-section" class="container my-5" style="display:none;">
        <div class="text-center mb-5">
            <img src="hta-logo.png" alt="Ø´Ø¹Ø§Ø± Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø£Ø¨Ù‚Ø±Ø§Ø·" class="hta-logo mb-3" loading="lazy">
            <h1 class="display-5 brand-green fw-bold">Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ³Ø¬ÙŠÙ„Ùƒ!</h1>
            <p class="lead text-muted">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø­Ø¯Ù‰ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø­Ø¬Ø² Ù…Ù‚Ø¹Ø¯Ùƒ.</p>
        </div>
        <div class="row g-4">
            <div class="col-md-6">
                <div class="card h-100 shadow payment-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-university me-2"></i>Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ù†ÙƒÙŠ</h5>
                        <p class="card-text">
                            <strong>Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:</strong> ACADEMYAT ABQRAT LEL TAALEM<br>
                            <strong>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:</strong> 0020174190615101<br>
                            <strong>IBAN:</strong> JO51UBSI1120000020174190615101<br>
                            <strong>SWIFT:</strong> UBSIJOAX
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card h-100 shadow payment-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-wallet me-2"></i>Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© (Ø²ÙŠÙ† ÙƒØ§Ø´)</h5>
                        <p class="card-text">
                            <strong>Ø§Ù„Ø±Ù‚Ù…:</strong> 00962796100112
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card h-100 shadow payment-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-mobile-alt me-2"></i>Ø®Ø¯Ù…Ø© CLIQ â€“ Ø¨Ù†Ùƒ Ø§Ù„Ø§ØªØ­Ø§Ø¯</h5>
                        <p class="card-text">
                            <strong>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±:</strong> HTAJO
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card h-100 shadow payment-card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-money-bill-wave me-2"></i>ØªØ­ÙˆÙŠÙ„ Ø¹Ø¨Ø± Ù…ÙƒØ§ØªØ¨ Ø§Ù„ØµØ±Ø§ÙØ©</h5>
                        <p class="card-text">
                            <strong>Ø§Ù„Ø§Ø³Ù…:</strong> AMER SALEH HUSSIEN AL-HAMDAN<br>
                            <small>(Ø§Ù„Ø¹Ù„Ø§ÙˆÙ†Ø© Ø£Ùˆ Ø£Ø¨Ùˆ Ø´ÙŠØ®Ø©)</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="alert alert-warning mt-5 text-center" role="alert">
            <h5 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø©</h5>
            <p class="mb-0">
                ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ø¹Ù† ÙˆØµÙ„ Ø§Ù„Ø¯ÙØ¹ Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„ <strong>ÙˆØ§Ø³Ù… ØµØ§Ø­Ø¨ Ø§Ù„Ø­Ø³Ø§Ø¨</strong> Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² Ø±Ø³Ù…ÙŠÙ‹Ø§. Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ ØªØ·Ø¨ÙŠÙ‚ ÙˆØ§ØªØ³Ø§Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù…: <strong>+962787269996</strong>.
            </p>
        </div>
        <div class="text-center mt-4">
            <a href="https://wa.me/962787269996" target="_blank" class="btn brand-green-bg text-white btn-lg">
                <i class="fab fa-whatsapp me-2"></i> Ø£Ø±Ø³Ù„ ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
            </a>
        </div>
    </section>

    <footer class="navbar-custom-bg text-white text-center py-4 mt-5">
        <div class="container">
            <p class="mb-2">
                <strong>Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± ÙˆØ§Ù„ØªÙˆØ§ØµÙ„:</strong>
                <a href="https://wa.me/962787269996" target="_blank" class="text-white text-decoration-none mx-2">
                    <i class="fab fa-whatsapp"></i> +962787269996
                </a>
            </p>
            <p class="mb-0">&copy; 2025 Hippocrates Training Academy. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ======================================================================= -->
    <!-- ========================= JAVASCRIPT LOGIC ========================= -->
    <!-- ======================================================================= -->
    <script>
        // --- Global Variables ---
        const CSV_SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTQghOdUAW_v2svTLHGwZWpWU2x7tdsE24m8LPOGKFZNlef2q91JD88aEoMF5psdDbJzYZV4TmhoWig/pub?gid=0&single=true&output=csv";
        let coursesDB = {};
        let currentCourse = null;

        // --- ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„ Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨ ---
        const countries = [
            { name: 'Ø§Ù„Ø£Ø±Ø¯Ù†', code: '+962' },
            { name: 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©', code: '+971' },
            { name: 'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†', code: '+973' },
            { name: 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±', code: '+213' },
            { name: 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', code: '+966' },
            { name: 'Ø§Ù„Ø³ÙˆØ¯Ø§Ù†', code: '+249' },
            { name: 'Ø§Ù„ØµÙˆÙ…Ø§Ù„', code: '+252' },
            { name: 'Ø§Ù„Ø¹Ø±Ø§Ù‚', code: '+964' },
            { name: 'Ø¹ÙÙ…Ø§Ù†', code: '+968' },
            { name: 'ÙÙ„Ø³Ø·ÙŠÙ†', code: '+970' },
            { name: 'Ù‚Ø·Ø±', code: '+974' },
            { name: 'Ø§Ù„ÙƒÙˆÙŠØª', code: '+965' },
            { name: 'Ù„Ø¨Ù†Ø§Ù†', code: '+961' },
            { name: 'Ù„ÙŠØ¨ÙŠØ§', code: '+218' },
            { name: 'Ù…ØµØ±', code: '+20' },
            { name: 'Ø§Ù„Ù…ØºØ±Ø¨', code: '+212' },
            { name: 'Ø§Ù„ÙŠÙ…Ù†', code: '+967' },
            { name: 'Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§', code: '+222' },
            { name: 'ØªÙˆÙ†Ø³', code: '+216' },
            { name: 'Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±', code: '+269' },
            { name: 'Ø¬ÙŠØ¨ÙˆØªÙŠ', code: '+253' },
            { name: 'Ø³ÙˆØ±ÙŠØ§', code: '+963' },
            { name: 'ØªØ±ÙƒÙŠØ§', code: '+90' },
            { name: 'Ø¥Ø³Ø±Ø§Ø¦ÙŠÙ„', code: '+972' } // ØªÙ…Øª Ø¥Ø¶Ø§ÙØªÙ‡Ø§ ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨
        ];

        // --- Event Listeners Initialization ---
        document.addEventListener("DOMContentLoaded", function() {
            initCountryCodeDropdown();
            loadCourses();

            const phoneInput = document.getElementById('phone-number');
            phoneInput.addEventListener('input', function(e) {
                if (e.target.value.startsWith('0')) {
                    e.target.value = e.target.value.substring(1);
                }
            });
        });

        // --- Functions for Course Management ---
        function loadCourses() {
            const selector = document.getElementById('course-selector');
            const loadingIndicator = document.createElement('div');
            loadingIndicator.className = 'text-center my-3';
            loadingIndicator.innerHTML = '<div class="spinner-border text-primary" role="status"><span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span></div>';
            selector.parentNode.appendChild(loadingIndicator);

            fetch(CSV_SHEET_URL).then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.text();
            }).then(csvText => {
                coursesDB = parseCSV(csvText);
                populateCourseDropdown();
                selector.disabled = false;
                loadingIndicator.remove();
            }).catch(error => {
                console.error('Error fetching courses:', error);
                selector.innerHTML = '<option value="" disabled selected>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©!</option>';
                selector.disabled = true;
                loadingIndicator.remove();
                const errorDiv = document.createElement('div');
                errorDiv.className = 'alert alert-danger mt-3';
                errorDiv.innerHTML = `<i class="fas fa-exclamation-circle"></i> Ø¹Ø°Ø±Ù‹Ø§ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ©. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ø£Ùˆ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ù‹Ø§.`;
                selector.parentNode.appendChild(errorDiv);
            });
        }

        function parseCSV(text) {
            const courses = {};
            const lines = text.split(/\r?\n/);
            if (lines.length < 2) return {};
            const headers = lines[0].split(',').map(h => h.trim());
            const idIndex = headers.indexOf('id');
            const nameIndex = headers.indexOf('name');
            const dateIndex = headers.indexOf('date');
            const basePriceIndex = headers.indexOf('basePrice');
            const cpdFeeIndex = headers.indexOf('cpdFee');
            const statusIndex = headers.indexOf('status');
            const facebookLinkIndex = headers.indexOf('facebookLink');
            const instructorIndex = headers.indexOf('instructor');
            const cpdPointsIndex = headers.indexOf('cpdPoints');

            for (let i = 1; i < lines.length; i++) {
                if (!lines[i]) continue;
                const data = lines[i].split(',');
                if (data.length > statusIndex && data[statusIndex].trim().toLowerCase() === 'active') {
                    const id = data[idIndex] ? data[idIndex].trim() : `course_${i}`;
                    courses[id] = {
                        name: data[nameIndex]?.trim() || 'N/A',
                        date: data[dateIndex]?.trim() || 'N/A',
                        currency: "Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ",
                        basePrice: parseInt(data[basePriceIndex]?.trim()) || 0,
                        cpdFee: parseInt(data[cpdFeeIndex]?.trim()) || 0,
                        facebookLink: data[facebookLinkIndex]?.trim() || '',
                        instructor: data[instructorIndex]?.trim() || '',
                        cpdPoints: parseInt(data[cpdPointsIndex]?.trim()) || 0
                    };
                }
            }
            return courses;
        }

        function populateCourseDropdown() {
            const selector = document.getElementById('course-selector');
            selector.innerHTML = '<option value="" disabled selected>-- Ø§Ø®ØªØ± ÙØ¹Ø§Ù„ÙŠØ© ØªØ¯Ø±ÙŠØ¨ÙŠØ© --</option>';
            let courseCount = 0;
            for (const id in coursesDB) {
                const option = document.createElement('option');
                option.value = id;
                option.textContent = coursesDB[id].name;
                selector.appendChild(option);
                courseCount++;
            }
            if (courseCount === 0) {
                 selector.innerHTML = '<option value="" disabled selected>-- Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ¹Ø§Ù„ÙŠØ§Øª ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ --</option>';
            }
        }

        function onCourseSelect() {
            const selector = document.getElementById('course-selector');
            const courseId = selector.value;
            const fieldsWrapper = document.getElementById('registration-fields');
            const detailsDisplay = document.getElementById('course-details-display');

            if (courseId && coursesDB[courseId]) {
                currentCourse = coursesDB[courseId];
                loadCourseData(currentCourse);
                fieldsWrapper.style.display = 'block';
            } else {
                fieldsWrapper.style.display = 'none';
                detailsDisplay.innerHTML = '';
            }
        }

        function loadCourseData(course) {
            let detailsHTML = `Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ ÙØ¹Ø§Ù„ÙŠØ© ØªØ¯Ø±ÙŠØ¨ÙŠØ© <strong>${course.name}</strong><br><small>(${course.date})</small>`;
            if (course.instructor) detailsHTML += `<span class="instructor-name"><i class="fas fa-chalkboard-teacher me-1"></i> Ø§Ù„Ù…Ø¯Ø±Ø¨: ${course.instructor}</span>`;
            if (course.cpdPoints > 0) detailsHTML += `<span class="cpd-points-display"><i class="fas fa-award me-1"></i> ${course.cpdPoints} Ù†Ù‚Ø·Ø© CPD Ù…Ø¹ØªÙ…Ø¯Ø©</span>`;
            if (course.facebookLink && course.facebookLink.startsWith('http')) {
                detailsHTML += `<a href="${course.facebookLink}" target="_blank" class="brand-green mt-1 d-block"><i class="fab fa-facebook me-2"></i> Ù…Ø´Ø§Ù‡Ø¯Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ÙŠØ© Ø¹Ù„Ù‰ ÙÙŠØ³Ø¨ÙˆÙƒ</a>`;
            }
            document.getElementById('course-details-display').innerHTML = detailsHTML;
            document.getElementById('total-fee').innerText = `${course.basePrice} ${course.currency}`;
            document.getElementById('cpd-fee-display').innerText = course.cpdFee;
            document.getElementById('course-id-input').value = course.name;
            document.getElementById('cpd').value = 'Ù„Ø§';
            toggleCPDFields('Ù„Ø§');
        }

        // --- Functions for UI Interaction ---
        function toggleCPDFields(value) {
            const cpdSection = document.getElementById('cpd-fields');
            const totalFee = document.getElementById('total-fee');
            if (value === 'Ù†Ø¹Ù…' && currentCourse) {
                cpdSection.style.display = 'block';
                totalFee.innerText = `${currentCourse.basePrice + currentCourse.cpdFee} ${currentCourse.currency}`;
            } else if(currentCourse) {
                cpdSection.style.display = 'none';
                totalFee.innerText = `${currentCourse.basePrice} ${currentCourse.currency}`;
            }
        }

        function toggleOtherNationality(value) {
            const otherField = document.getElementById('other-nationality-field');
            otherField.style.display = (value === 'Ø£Ø®Ø±Ù‰') ? 'block' : 'none';
        }

        // --- Functions for Country Code Dropdown ---
        function initCountryCodeDropdown() {
            const searchInput = document.getElementById('country-code-search');
            const hiddenInput = document.getElementById('country-code-value');
            const listElement = document.getElementById('country-list');

            function setDefaultCountry() {
                const defaultCountry = countries.find(c => c.code === '+962');
                if (defaultCountry) {
                    searchInput.value = `${defaultCountry.name} (${defaultCountry.code})`;
                    hiddenInput.value = defaultCountry.code;
                }
            }

            function filterList() {
                const searchTerm = searchInput.value.toLowerCase();
                const items = listElement.getElementsByTagName('li');
                let hasResults = false;
                for (const item of items) {
                    const itemName = item.dataset.name.toLowerCase();
                    const itemCode = item.dataset.code;
                    if (itemName.includes(searchTerm) || itemCode.includes(searchTerm)) {
                        item.style.display = 'block';
                        hasResults = true;
                    } else {
                        item.style.display = 'none';
                    }
                }
                listElement.style.display = hasResults ? 'block' : 'none';
            }

            function selectCountry(e) {
                if (e.target && e.target.tagName === 'LI') {
                    const code = e.target.dataset.code;
                    const name = e.target.dataset.name;
                    searchInput.value = `${name} (${code})`;
                    hiddenInput.value = code;
                    listElement.style.display = 'none';
                }
            }

            countries.forEach(country => {
                const li = document.createElement('li');
                li.textContent = `${country.name} (${country.code})`;
                li.dataset.code = country.code;
                li.dataset.name = country.name;
                listElement.appendChild(li);
            });

            setDefaultCountry();
            searchInput.addEventListener('input', filterList);
            searchInput.addEventListener('focus', () => listElement.style.display = 'block');
            listElement.addEventListener('click', selectCountry);
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.custom-country-code-dropdown')) {
                    listElement.style.display = 'none';
                }
            });
        }

        // --- Form Validation and Submission ---
        function validateForm() {
            const errors = [];
            const fullNameAr = document.getElementById('fullNameAr').value.trim();
            const fullNameEn = document.getElementById('fullNameEn').value.trim();
            const email = document.getElementById('email').value.trim();
            const countryCodeInput = document.getElementById('country-code-search').value;
            const phoneNumber = document.getElementById('phone-number').value.trim();
            const terms = document.getElementById('terms').checked;
            const nationality = document.getElementById('nationality').value;
            const otherNationality = document.getElementById('other-nationality-field').querySelector('input').value.trim();
            const cpdRequest = document.getElementById('cpd').value;
            const nationalId = document.getElementById('nationalId').value.trim();
            const licenseNo = document.getElementById('licenseNo').value.trim();

            if (!/^[\u0600-\u06FF\s]+$/.test(fullNameAr)) errors.push('Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø­Ø±Ù Ø¹Ø±Ø¨ÙŠØ© ÙÙ‚Ø·.');
            // --- ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨ ---
            if (!/^[a-zA-Z\s]+$/.test(fullNameEn)) errors.push('The English name should contain only English letters.');
            if (!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)) errors.push('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­.');
            if (!countries.some(c => `${c.name} (${c.code})` === countryCodeInput.trim())) errors.push('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø±Ù…Ø² Ø¨Ù„Ø¯ ØµØ­ÙŠØ­ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.');
            if (!/^[1-9][0-9]{6,14}$/.test(phoneNumber)) errors.push('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…Ø­Ù„ÙŠ ØµØ­ÙŠØ­ (Ø¨Ø¯ÙˆÙ† Ø§Ù„ØµÙØ± ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©ØŒ Ù…Ø«Ù„ 79xxxxxxx).');
            if (!nationality) errors.push('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©.');
            if (nationality === 'Ø£Ø®Ø±Ù‰' && !otherNationality) errors.push('ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø¨Ù„Ø¯ Ø§Ù„Ø¬Ù†Ø³ÙŠØ©.');
            if (cpdRequest === 'Ù†Ø¹Ù…' && (!nationalId || !licenseNo)) errors.push('Ø¹Ù†Ø¯ Ø·Ù„Ø¨ Ø´Ù‡Ø§Ø¯Ø© CPDØŒ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ ÙˆØ±Ù‚Ù… Ø§Ù„Ù…Ø²Ø§ÙˆÙ„Ø©.');
            if (!terms) errors.push('ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù‡Ø¯ ÙˆØ§Ù„Ø¥Ù‚Ø±Ø§Ø± Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„.');

            if (errors.length > 0) {
                const errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
                document.getElementById('errorMessage').innerHTML = errors.join('<br>');
                errorModal.show();
                return false;
            }
            return true;
        }

        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            if (!validateForm()) return;

            const form = e.target;
            const data = new FormData(form);
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzOGhFt4kObXlGdGVcVIgPlyFOtvtutfPSvPNCK0fqn8RTwqeSFhPZwQpmAembejZLE/exec'; 
            const submitButton = form.querySelector('button[type="submit"]');

            const countryCode = document.getElementById('country-code-value').value;
            const phoneNumber = document.getElementById('phone-number').value.trim();
            const fullPhoneNumber = countryCode + phoneNumber;
            data.set('WhatsApp', fullPhoneNumber);
            data.delete('CountryCode');
            data.delete('Phone Number');

            submitButton.disabled = true;
            submitButton.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';

            fetch(scriptURL, { method: 'POST', body: data })
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(result => {
                console.log('Success!', result);
                const successModal = new bootstrap.Modal(document.getElementById('successModal'));
                
                // === ØªØ­Ø¯ÙŠØ« Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­ ===
                const userName = document.getElementById('fullNameAr').value.trim();
                const courseName = currentCourse.name;
                const totalFee = document.getElementById('total-fee').innerText;
                
                document.getElementById('successMessage').innerHTML = `
                    <p>Ø¹Ø²ÙŠØ²ÙŠ/Ø¹Ø²ÙŠØ²ØªÙŠ <strong>${userName}</strong>ØŒ</p>
                    <p>Ø´ÙƒØ±Ø§Ù‹ Ø¬Ø²ÙŠÙ„Ø§Ù‹ Ø¹Ù„Ù‰ ØªØ³Ø¬ÙŠÙ„Ùƒ ÙÙŠ ÙØ¹Ø§Ù„ÙŠØ© <strong>${courseName}</strong>. Ù†Ø­Ù† Ø³Ø¹Ø¯Ø§Ø¡ Ø¨Ø§Ù†Ø¶Ù…Ø§Ù…Ùƒ Ø¥Ù„ÙŠÙ†Ø§!</p>
                    <p>ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØªØ£ÙƒÙŠØ¯ÙŠ Ø¥Ù„Ù‰ <strong>${document.getElementById('email').value}</strong> ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ®Ø·ÙˆØ§Øª Ø§Ù„Ø¯ÙØ¹.</p>
                    <p><strong>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong> ${totalFee}</p>
                    <p>ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ Ù„Ø¥ØªÙ…Ø§Ù… Ø­Ø¬Ø² Ù…Ù‚Ø¹Ø¯Ùƒ. Ø´ÙƒØ±Ø§Ù‹ Ù„Ø«Ù‚ØªÙƒÙ… Ø¨Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø£Ø¨Ù‚Ø±Ø§Ø·.</p>
                `;
                // === Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠØ« ===

                successModal.show();

                setTimeout(() => {
                    document.getElementById('registration-section').style.display = 'none';
                    document.getElementById('payment-section').style.display = 'block';
                    window.scrollTo(0, 0);
                }, 2000);

            })
            .catch(error => {
                console.error('Fetch Error!', error.message);
                submitButton.disabled = false;
                submitButton.textContent = 'Ø£Ø±Ø³Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙŠ ÙˆØ§Ø¹Ø±Ø¶ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹';
                const errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
                document.getElementById('errorMessage').textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
                errorModal.show();
            });
        });

    </script>
</body>
</html>
